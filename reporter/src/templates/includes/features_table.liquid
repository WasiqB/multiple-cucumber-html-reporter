<div class="rounded-xl border bg-card text-card-foreground shadow overflow-hidden" id="features-table-container">
    <div class="px-6 py-4 border-b flex flex-col md:flex-row md:items-center justify-between gap-4">
        <h3 class="text-lg font-semibold whitespace-nowrap">Features Overview</h3>
        <div class="flex flex-wrap items-center gap-3 w-full md:w-auto">
            <div class="relative flex-1 md:w-64">
                <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-muted-foreground">
                    <i class="fa-solid fa-magnifying-glass text-xs"></i>
                </span>
                <input type="text" id="feature-search" placeholder="Search features..." 
                        class="w-full h-9 pl-9 pr-4 rounded-md border border-input bg-background text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-shadow shadow-sm">
            </div>
            <div class="flex items-center gap-2">
                <span class="text-xs font-medium text-muted-foreground whitespace-nowrap">Show:</span>
                <select id="records-per-page" 
                        class="h-9 px-2 rounded-md border border-input bg-background text-xs ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 transition-shadow shadow-sm min-w-[70px]">
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
            </div>
        </div>
    </div>
    <div class="overflow-x-auto">
        <table class="w-full text-sm text-left">
            <thead class="bg-muted text-muted-foreground uppercase text-xs font-semibold">
                <tr>
                    <th class="px-4 md:px-6 py-3 cursor-pointer hover:text-foreground transition-colors group">
                        <div class="flex items-center gap-1.5">
                            Feature Name
                            <i class="fa-solid fa-sort opacity-30 group-hover:opacity-100 text-[10px]"></i>
                        </div>
                    </th>
                    <th class="px-4 md:px-6 py-3">Device / Browser</th>
                    <th class="px-4 md:px-6 py-3 cursor-pointer hover:text-foreground transition-colors group">
                        <div class="flex items-center gap-1.5">
                            Steps status
                            <i class="fa-solid fa-sort opacity-30 group-hover:opacity-100 text-[10px]"></i>
                        </div>
                    </th>
                    <th class="px-4 md:px-6 py-3 text-right cursor-pointer hover:text-foreground transition-colors group">
                        <div class="flex items-center justify-end gap-1.5">
                            Pass %
                            <i class="fa-solid fa-sort opacity-30 group-hover:opacity-100 text-[10px]"></i>
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody id="features-table-body" class="divide-y divide-border">
                {% comment %} Initial render by Liquid for SEO/no-JS {% endcomment %}
                {% for feature in data.features limit: 10 %}
                <tr class="hover:bg-muted/50 transition-colors">
                    <td class="px-4 md:px-6 py-4 whitespace-nowrap md:whitespace-normal min-w-[200px]">
                        <a href="features/{{ feature.id }}.html" class="font-medium text-primary hover:underline">
                            {{ feature.name }}
                        </a>
                        <div class="flex flex-wrap gap-1 mt-1">
                            {% for tag in feature.tags %}
                            <span class="inline-flex items-center rounded-full bg-secondary px-2 py-0.5 text-[10px] font-medium text-secondary-foreground">
                                {{ tag.name }}
                            </span>
                            {% endfor %}
                        </div>
                    </td>
                    <td class="px-4 md:px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center gap-2 text-foreground font-medium">
                            <i class="fa-solid fa-desktop text-muted-foreground w-4"></i>
                            {{ feature.metadata.device | default: "Desktop" }}
                        </div>
                        <div class="flex items-center gap-2 text-xs text-muted-foreground mt-1">
                             <span class="flex items-center gap-1">
                                <i class="fa-solid fa-laptop-code w-3"></i>
                                {{ feature.metadata.platform.name | default: "N/A" }}
                            </span>
                            <span class="opacity-30">/</span>
                            <span class="flex items-center gap-1">
                                <i class="fa-solid fa-globe w-3"></i>
                                {{ feature.metadata.browser.name | default: "N/A" }}
                            </span>
                        </div>
                    </td>
                    <td class="px-4 md:px-6 py-4 whitespace-nowrap">
                        <div class="flex h-2 w-24 md:w-32 overflow-hidden rounded-full bg-secondary">
                            {% if feature.scenarios.passed > 0 %}
                            <div class="h-full bg-green-500" style="width: {{ feature.scenarios.passed | plus: 0.0 | divided_by: feature.scenarios.total | times: 100 }}%"></div>
                            {% endif %}
                            {% if feature.scenarios.failed > 0 %}
                            <div class="h-full bg-red-500" style="width: {{ feature.scenarios.failed | plus: 0.0 | divided_by: feature.scenarios.total | times: 100 }}%"></div>
                            {% endif %}
                            {% if feature.scenarios.skipped > 0 %}
                            <div class="h-full bg-yellow-500" style="width: {{ feature.scenarios.skipped | plus: 0.0 | divided_by: feature.scenarios.total | times: 100 }}%"></div>
                            {% endif %}
                        </div>
                        <div class="mt-1 flex gap-2 text-[10px] font-medium uppercase">
                            <span class="text-green-600">{{ feature.passed }} Passed</span>
                            <span class="text-red-600">{{ feature.failed }} Failed</span>
                            <span class="text-yellow-600">{{ feature.skipped }} Skipped</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 text-right">
                         {% assign total = feature.passed | plus: feature.failed | plus: feature.skipped %}
                         {% if total > 0 %}
                            {{ feature.passed | times: 100 | divided_by: total }}%
                         {% else %}
                            0%
                         {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="px-6 py-4 border-t flex items-center justify-between text-xs text-muted-foreground bg-muted/20">
        <div>
            Showing <span id="showing-start" class="font-bold text-foreground">1</span> to <span id="showing-end" class="font-bold text-foreground">10</span> of <span id="total-records" class="font-bold text-foreground">{{ data.features.size }}</span> entries
        </div>
        <div class="flex items-center gap-1" id="pagination-controls">
            <button id="prev-page" class="h-8 w-8 flex items-center justify-center rounded border border-transparent text-foreground hover:bg-muted hover:border-border transition-all disabled:opacity-30 disabled:cursor-not-allowed">
                <i class="fa-solid fa-chevron-left"></i>
            </button>
            <div id="page-numbers" class="flex items-center gap-1">
                <!-- Page buttons will be injected here -->
            </div>
            <button id="next-page" class="h-8 w-8 flex items-center justify-center rounded border border-transparent text-foreground hover:bg-muted hover:border-border transition-all disabled:opacity-30 disabled:cursor-not-allowed">
                <i class="fa-solid fa-chevron-right"></i>
            </button>
        </div>
    </div>
</div>
